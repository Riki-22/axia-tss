# ビジネス要件定義

**Document Path**: `docs/logical_design/business_requirements.md`  
**Version**: 1.0  
**Type**: ビジネス要件定義書  
**Last Updated**: 2025-10-19

---

## 目次

- [1. システム概要](#1-システム概要)
- [2. ビジョンとミッション](#2-ビジョンとミッション)
- [3. ステークホルダー](#3-ステークホルダー)
- [4. ユーザーストーリー](#4-ユーザーストーリー)
- [5. 機能要件](#5-機能要件)
- [6. 非機能要件](#6-非機能要件)
- [7. 制約条件](#7-制約条件)
- [8. 成功指標](#8-成功指標)

---

## 1. システム概要

### システム名
**AXIA Trading Strategy System (AXIA-TSS)**

### システム目的
個人投資家向け自動FX取引システムとして、データ駆動型の取引判断により感情や認知バイアスを排除し、24時間365日の自動取引を通じて持続可能な収益を実現する。

### プロジェクトの背景
- 手動取引での感情的判断による損失
- 24時間市場監視の物理的不可能性
- 複数のテクニカル指標を統合した判断の困難さ
- リスク管理の一貫性確保の必要性

---

## 2. ビジョンとミッション

### ビジョン
**市場の複雑性と不確実性に対して、データ駆動型の意思決定と継続的な学習により、持続可能な収益を実現する自律型取引システムを構築する**

### ミッション
1. **感情排除**: 感情や認知バイアスを完全に排除した純粋に論理的な取引判断
2. **24時間稼働**: 市場機会を逃さない完全自動取引の提供
3. **適応性**: 市場環境の変化に動的に適応する知的な取引戦略
4. **リスク管理**: 資産保全を最優先とした堅牢なリスク管理メカニズム

### 価値提案
| 領域 | 従来の課題 | AXIAの解決策 | 提供価値 |
|------|------------|--------------|----------|
| **判断品質** | 感情的・衝動的な取引判断 | データ駆動型の論理的判断 | 一貫性のある高品質な意思決定 |
| **市場カバレッジ** | 限定的な監視時間 | 24時間365日の自動監視 | 機会損失の最小化 |
| **戦略適応** | 固定的な取引ルール | 動的な戦略選択メカニズム | 市場環境への最適な適応 |
| **リスク管理** | 手動での損切り判断 | 自動リスク制御システム | 確実な資産保全 |

---

## 3. ステークホルダー

### プライマリーステークホルダー
| ステークホルダー | 役割 | 主要関心事 |
|-----------------|------|-----------|
| **個人投資家（システムオーナー）** | システム利用者・意思決定者 | 収益性、安全性、操作性 |
| **取引ブローカー（MT5）** | 取引実行プラットフォーム | 取引量、システム安定性 |

### セカンダリーステークホルダー
| ステークホルダー | 役割 | 主要関心事 |
|-----------------|------|-----------|
| **システム開発者** | システム構築・保守 | 技術的実現可能性、保守性 |
| **AWS** | インフラプロバイダー | サービス利用量、コスト効率 |
| **金融当局** | 規制・監督 | コンプライアンス、リスク管理 |

---

## 4. ユーザーストーリー

### エピック1: 自動取引システム
**As a** 個人投資家  
**I want** システムが自動的に取引を実行する  
**So that** 24時間市場を監視し機会を逃さない  

#### ユーザーストーリー
- **US001**: 複数のテクニカル指標に基づいた自動エントリー
- **US002**: 市場環境に応じた動的な利確・損切り
- **US003**: リスク許容度に基づいた自動ポジションサイズ計算
- **US004**: 緊急時の即座な全取引停止（Kill Switch）

### エピック2: 市場分析・監視
**As a** 個人投資家  
**I want** リアルタイムで市場分析結果を確認する  
**So that** システムの判断根拠を理解できる  

#### ユーザーストーリー
- **US005**: リアルタイム価格チャートの表示
- **US006**: テクニカル指標とシグナルの可視化
- **US007**: 市場レジーム（トレンド/レンジ）の判定表示
- **US008**: ポジション状況とリアルタイム損益の監視

### エピック3: リスク管理
**As a** 個人投資家  
**I want** システムが自動的にリスクを管理する  
**So that** 大きな損失から資産を保護できる  

#### ユーザーストーリー
- **US009**: 日次損失上限の自動監視
- **US010**: ドローダウン閾値での自動取引停止
- **US011**: ポジション数制限の自動管理
- **US012**: ボラティリティに応じた動的ストップロス

### エピック4: 手動操作・監視
**As a** 個人投資家  
**I want** 必要時に手動で取引や設定を行う  
**So that** 特殊な市場状況に対応できる  

#### ユーザーストーリー
- **US013**: 手動での注文実行（BUY/SELL）
- **US014**: Kill Switchの手動有効化・無効化
- **US015**: システム稼働状況のリアルタイム監視
- **US016**: ポジションの手動決済

---

## 5. 機能要件

### 5.1 自動取引機能（必須）
- **FR001**: 複数テクニカル指標（10種類）による総合的な取引判断
- **FR002**: 市場環境（トレンド/レンジ）に応じた戦略選択
- **FR003**: ベイズ推論による確率的エントリー判定
- **FR004**: 動的利確・損切りライン設定
- **FR005**: 自動ポジションサイズ計算（固定リスク額基準）

### 5.2 リスク管理機能（必須）
- **FR006**: Kill Switch（緊急停止）機能
- **FR007**: 日次損失上限監視（口座資金の2%）
- **FR008**: 最大ドローダウン監視（口座資金の5%）
- **FR009**: ポジション数制限（最大3ポジション）
- **FR010**: 通貨ペア相関リスク管理

### 5.3 データ管理機能（必須）
- **FR011**: リアルタイム市場データ取得・保存
- **FR012**: 過去データの効率的な読み込み（S3/Redis/MT5）
- **FR013**: データ鮮度管理とフォールバック機能
- **FR014**: 取引履歴の永続化（DynamoDB）

### 5.4 監視・UI機能（必須）
- **FR015**: リアルタイム価格チャート表示
- **FR016**: ポジション状況・損益のリアルタイム表示
- **FR017**: システム稼働状況監視
- **FR018**: 手動注文実行機能

### 5.5 バックテスト機能（将来実装）
- **FR019**: 過去データによる戦略検証
- **FR020**: パフォーマンス分析レポート生成
- **FR021**: パラメータ最適化機能

---

## 6. 非機能要件

### 6.1 パフォーマンス要件
| 項目 | 要件 | 測定方法 |
|------|------|---------|
| **取引判断速度** | 1分以内でエントリー/エグジット判断 | システムログ分析 |
| **データ取得** | Redis: 100ms以内、S3: 5秒以内 | レスポンス時間測定 |
| **UI応答性** | Streamlit画面描画1秒以内 | ブラウザ開発者ツール |
| **同時処理** | 複数通貨ペアの並列処理対応 | リソース使用率監視 |

### 6.2 可用性要件
| 項目 | 要件 | 実現方法 |
|------|------|---------|
| **システム稼働率** | 99%以上（月間7時間以内の停止） | AWS CloudWatch監視 |
| **データ可用性** | MT5障害時のフォールバック機能 | yfinance等代替データソース |
| **自動復旧** | プロセス異常終了時の自動再起動 | systemd/タスクスケジューラ |

### 6.3 信頼性要件
| 項目 | 要件 | 実現方法 |
|------|------|---------|
| **データ整合性** | 取引データの完全性保証 | DynamoDB条件付き書き込み |
| **注文実行精度** | 注文失敗率1%以下 | エラーハンドリング・リトライ |
| **バックアップ** | 重要データの日次バックアップ | S3自動バックアップ |

### 6.4 スケーラビリティ要件
| 項目 | 要件 | 実現方法 |
|------|------|---------|
| **通貨ペア拡張** | 最大10通貨ペアまで対応 | 設定ベース拡張 |
| **データ量増加** | 5年分の履歴データ対応 | S3階層化ストレージ |
| **処理能力** | EC2スケールアップ対応 | t3.small → t3.medium |

### 6.5 セキュリティ要件
| 項目 | 要件 | 実現方法 |
|------|------|---------|
| **認証情報保護** | MT5認証情報の暗号化保存 | AWS Secrets Manager |
| **通信暗号化** | 全てのAWS通信をTLS化 | HTTPS/WSS利用 |
| **アクセス制御** | IAMロールベースアクセス | 最小権限の原則 |
| **監査ログ** | 全取引・設定変更のログ記録 | CloudTrail連携 |

### 6.6 運用性要件
| 項目 | 要件 | 実現方法 |
|------|------|---------|
| **監視** | システム状態のリアルタイム監視 | CloudWatch/Streamlit |
| **アラート** | 異常時の即座な通知 | SNS/Slack連携 |
| **設定変更** | パラメータの動的変更対応 | 設定ファイル/環境変数 |
| **ログ管理** | 構造化ログによる問題特定 | JSON形式ログ |

---

## 7. 制約条件

### 7.1 技術的制約
| 制約項目 | 詳細 | 影響 |
|---------|------|------|
| **ブローカー依存** | MT5ブローカーのみ対応 | 他ブローカー利用不可 |
| **プラットフォーム** | AWS限定、他クラウド非対応 | ベンダーロックイン |
| **プログラミング言語** | Python 3.11+のみ | 他言語ライブラリ利用不可 |
| **データ取得頻度** | MT5の制限に依存 | 高頻度取引（HFT）非対応 |

### 7.2 ビジネス制約
| 制約項目 | 詳細 | 影響 |
|---------|------|------|
| **予算制限** | 月額$50以下のインフラコスト | 高性能リソース利用制限 |
| **法的制約** | 個人利用のみ、商用利用禁止 | 第三者への提供不可 |
| **地理的制約** | 日本国内からの利用のみ | 海外サーバー利用制限 |
| **資金制約** | 初期投資額100万円以内 | 高リスク戦略採用不可 |

### 7.3 運用制約
| 制約項目 | 詳細 | 影響 |
|---------|------|------|
| **監視時間** | 平日のみ能動的監視 | 週末異常時の対応遅延 |
| **保守要員** | 開発者1名のみ | 障害時の対応能力制限 |
| **テスト環境** | 本番環境での検証 | テスト時のリスク |

### 7.4 外部システム依存
| 依存先 | 依存内容 | リスク軽減策 |
|--------|----------|-------------|
| **MT5ブローカー** | 取引実行・データ取得 | 複数ブローカー検討 |
| **AWS** | 全インフラサービス | 重要データのローカルバックアップ |
| **yfinance** | フォールバックデータ | 複数データソース準備 |
| **インターネット** | 全通信 | モバイル回線での冗長化 |

---

## 8. 成功指標

### 8.1 ビジネス指標
| 指標 | 目標値 | 測定期間 | 測定方法 |
|------|--------|---------|---------|
| **月次収益率** | +2%以上 | 毎月 | MT5口座残高比較 |
| **年間収益率** | +20%以上 | 年次 | 年初年末比較 |
| **最大ドローダウン** | -5%以内 | 継続監視 | 口座残高履歴分析 |
| **勝率** | 60%以上 | 月次 | 勝敗取引数比率 |
| **プロフィットファクター** | 1.5以上 | 月次 | 総利益/総損失 |

### 8.2 技術指標
| 指標 | 目標値 | 測定期間 | 測定方法 |
|------|--------|---------|---------|
| **システム稼働率** | 99%以上 | 月次 | CloudWatch稼働時間 |
| **取引実行成功率** | 99%以上 | 日次 | 注文ログ分析 |
| **データ取得成功率** | 95%以上 | 日次 | データ収集ログ分析 |
| **応答時間** | 平均1秒以内 | 日次 | Streamlit応答時間 |

### 8.3 運用指標
| 指標 | 目標値 | 測定期間 | 測定方法 |
|------|--------|---------|---------|
| **月次運用コスト** | $50以下 | 月次 | AWS請求額 |
| **障害対応時間** | 平均4時間以内 | 障害発生時 | インシデント記録 |
| **Kill Switch作動回数** | 月1回以下 | 月次 | システムログ |
| **手動介入回数** | 週1回以下 | 週次 | 操作ログ |

### 8.4 リスク指標
| 指標 | 目標値 | 測定期間 | 測定方法 |
|------|--------|---------|---------|
| **日次損失限度違反** | 0回 | 月次 | リスク管理ログ |
| **同時保有ポジション数** | 3以下 | 継続監視 | ポジション管理データ |
| **レバレッジ** | 10倍以下 | 継続監視 | MT5口座情報 |
| **相関ポジションリスク** | 相関係数0.7以下 | 日次 | 相関分析結果 |

---

## 付録

### A. 用語集
| 用語 | 定義 |
|------|------|
| **Kill Switch** | 全取引を即座に停止する緊急停止機能 |
| **ドローダウン** | 口座残高のピークからの最大下落率 |
| **プロフィットファクター** | 総利益を総損失で割った比率 |
| **相関係数** | 2つの通貨ペア間の価格相関の強さ（-1〜1） |
| **ボラティリティ** | 価格変動の大きさを示す指標 |

### B. 関連ドキュメント
- `docs/logical_design/domain_model.md` - ドメインモデル設計
- `docs/logical_design/functional_design.md` - 機能設計詳細
- `docs/physical_design/aws_architecture.md` - AWS構成設計
- `docs/project_management/project_plan_v3.md` - プロジェクト計画書

---

**Document Version**: 1.0  
**Last Updated**: 2025-10-19  
**Next Review**: 2025-11-19